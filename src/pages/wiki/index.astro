---
import Card from '@/components/card/index.astro'
import { baseHref } from '@/helpers/href'
import { getCategorizedAuthCollection } from '@/helpers/loaders'
import Base from '@/layouts/base.astro'
import { config as wikiConfig } from '@/wiki/constants'

const authCollection = await getCategorizedAuthCollection()
---

<Base title="Wiki">
  <div class="container mx-auto px-6 lg:px-8">
    <div class="mx-auto max-w-5xl py-16">
      <div class="animate-fade-up mb-14 border-b border-border pb-8">
        <p class="mb-3 font-mono-display text-xs font-medium uppercase tracking-[0.15em] text-electric">
          Documentation Hub
        </p>
        <h1 class="font-mono-display text-5xl font-bold leading-none tracking-tight text-foreground">
          Knowledge Base
        </h1>
      </div>

      {
        wikiConfig.map(({ title, description, categories }, i) => {
          return (
            <div class={`animate-fade-up delay-${(i + 2) * 100} space-y-6 pb-14`}>
              <div class="flex items-baseline gap-6">
                <h2 class="shrink-0 font-mono-display text-2xl font-bold text-foreground">
                  {title}
                </h2>
                <div class="h-px flex-1 bg-border" />
              </div>
              <p class="max-w-xl text-sm text-muted-foreground">{description}</p>
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:gap-6">
                {categories.map(({ category, description, title }) => {
                  const id = authCollection[category].at(0)?.id
                  return (
                    <Card
                      href={id ? baseHref(`/wiki/authentication/${id}`) : undefined}
                    >
                      <div class="flex flex-col space-y-3">
                        <p class="font-mono-display text-[10px] font-medium uppercase tracking-[0.1em] text-electric">
                          {category}
                        </p>
                        <h3 class="text-lg font-medium text-foreground">{title}</h3>
                        <p class="text-sm text-muted-foreground">{description}</p>
                      </div>
                    </Card>
                  )
                })}
              </div>
            </div>
          )
        })
      }
    </div>
  </div>
</Base>

---
import { BASE } from '@/helpers/constants'
import { parseClassNames } from '@/helpers/parseClassNames'
import type { NavigationItem } from '@/types'

interface Props {
  items: Array<NavigationItem>
}

const { items } = Astro.props

const { pathname } = Astro.url
---

<aside
  transition:name="nav-aside"
  transition:animate="none"
  class="hidden w-52 shrink-0 py-8 pr-4 md:block"
>
  <div class="sticky top-20 h-[calc(100vh-8rem)] self-start overflow-y-auto">
    {
      items.map(({ display, children }) => {
        return (
          <div class="mb-8">
            <h4 class="font-mono-display text-muted-foreground mb-3 text-[10px] font-medium tracking-[0.15em] uppercase">
              {display}
            </h4>
            <div class="grid grid-flow-row auto-rows-max">
              {children?.map(({ display, route }) => {
                const href = `${BASE}${route}`
                const hrefRegexp = new RegExp(`^${href}/?$`)
                const isActive = hrefRegexp.test(pathname)
                return (
                  <a
                    href={href}
                    class={parseClassNames(
                      'relative flex w-full items-center border-l py-1.5 pl-3 text-sm transition-colors',
                      ['border-electric text-foreground', isActive],
                      [
                        'text-muted-foreground hover:text-foreground border-transparent',
                        !isActive,
                      ],
                    )}
                  >
                    {display}
                  </a>
                )
              })}
            </div>
          </div>
        )
      })
    }
  </div>
</aside>
